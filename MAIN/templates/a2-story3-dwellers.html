{% extends 'base.html' %}
{% load static %}
  {% block title %}
    <title>Dwellers of The Town</title>
    <link rel="stylesheet" href="{% static 'css\main.css' %}">
    <link rel="stylesheet" href="{% static 'css\nav.css' %}">
    <link rel="stylesheet" href="{% static 'css\scroll.css' %}">
    <link rel="stylesheet" href="{% static 'css\forum.css' %}">
    <link rel="stylesheet" href="{% static 'css\storycontent.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
      @media screen and (max-width: 768px) {
    .nav-to-right, .nav-line{
      margin-left: 20px;
    }
    .nav-link{
      margin-left: 20px;
      margin-right: 0;
    }
  }
</style>
{% endblock title %}
{% block content %}  

<!--nav link-->
<div class="nav-link">
  <div class="nav-link-content">
    <a href="{% url 'home' %}"><i class="fa-solid fa-house"></i></a>
    <i class="fa-solid fa-chevron-right"></i>
    <p> <a href="{% url 'story' %}"> Story </a><span><i class="fa-solid fa-chevron-right"></i></span> Dwellers of The Town</p>
  </div> 
</div>
<hr class ="nav-line">
<br>
<!--bookmark and comment-->
<div class="nav-to-right">
  <div class="nav-to-right-content">
    <p><i class="fa-regular fa-bookmark fa-2x" onclick="toggleBookmark(this, 'Story-Dwellers-of-The-Town')" data-slug="Story-Dwellers-of-The-Town"></i></i></p>
    <button onclick="on()">See Discussion <i class="fa-regular fa-comment"></i></button>
  </div>
</div>

 <!--Forum Section-->
<div class="overlay" id="overlay">
    <div class="container">
        <div class="close">
            <div class="close-button">
                <i class="fas fa-times" onclick="off()"></i>
            </div>         
            <div class="subforum">
            {% if user.is_authenticated %}
              <div class ="create-post">
                <button style="color:#38444d"><a href="{% url 'create_post' %}">Create Post</a></button>
              </div>
            {% endif %}
  
            <div class="subforum-title">
                <h1>Forum</h1>
            </div>
  
            {% for forum in forums %}
            <div class="subforum-row">
                <!--<div class="subforum-icon subforum-column center">
                    <i class="fas fa-user"></i>
                </div>-->
                <div class="subforum-description subforum-column">
                    <h1><a href="{{forum.get_url}}">{{forum.title}}</a></h1>
                    <p>{{forum.description}}</p>
                </div>
                <div class="subforum-stats subforum-column center">
                    <span>{{forum.num_posts}} Posts</span>
                </div>
                <div class="subforum-info subforum-column">
                    <b><a href="{{forum.last_post.get_url}}">Last Post</a></b> by <a href="">{{forum.last_post.user.fullname|title}}</a>
                    <br>
                    on <small>{{forum.last_post.created_at|date:"F d, Y H:i"}}</small>
                </div>
            </div>
            {% endfor %}
  
        </div>
  
    </div>
  
     <!-- Forum Info -->
  <div class="forum-info">
    <div class="chart">
        Forum Statistic &nbsp;<i class="fa fa-bar-chart"></i>
    </div>
    <span><u>{{num_posts}}</u> Posts in <u>{{num_categories}}</u> Categories by <u>{{num_users}}</u> Members.</span><br>
    {% if forums %}
        <span>Latest post: <b><a href="{{last_post.get_url}}">{{last_post.title}}</a></b> on {{last_post.date|date}} By <a href="">{{last_post.user.fullname|title}}</a></span>.<br>
        <span>Check <a href="{% url 'latest_posts' %}">the latest posts</a> .</span><br>
    {% endif %}
  </div>
  
  <script src="{% static 'js/trialforum.js' %}"></script>           
  
  </div>
  </div>
  <!--ends forum-->

<!--image content parallax-->
<div class="parallax" style="background-image:linear-gradient(rgba(0,0,0,0.3),rgba(0,0,0,0.5)), url(https://images.squarespace-cdn.com/content/v1/57b9b98a29687f1ef5c622df/1473084050234-0VJSL3SOZRQ7SXYWW2GR/old+dubai);">
  <h1>Dwellers of The Town</h1>
</div>

<style>
 .sidenav{
    width: 200px;
    position: fixed;
    height: 100%;
    left: 0;
    top: 806px;
    z-index: 2;
    overflow-x: hidden;
  }
  .sidenav a{
    padding: 10px 0px 10px 30px;
    text-decoration: none;
    font-size: 14px;
    color: #38444d;
    display: block;
  }
  .sidenav a:hover{
    color: #004085;
  }
  .story1{ 
    padding: 50px 150px 100px 60px;
    margin-left: 200px;
    align-items: center;
    text-align: justify;
  }
  .story1 .h4{
    text-align: center;
  }
  .story1 .p{
    text-align: justify;
  }

  hr .line{
    border: 0;
    height: 2px;
    width: 100%;
    margin: 15px 0 10px;
  }
.toggle-story {
  display: none;
}
  /* Adjustments for mobile view */
  @media screen and (max-width: 768px) {
    .sidenav {
      display: none;
    }
  /* Adjust content padding to not overlap with the sidenav */
  .story1 {
    padding: 20px;
    margin-bottom: 60px; /* Add space at the bottom for sidenav */
    margin-left: 0;
  }
}
</style>
<div class="sidenav"> 
  <ul>
    <li><a href="#intro">Introduction</a></li>
    <li><a href="#messengers">Messengers Sent</a></li>
    <li><a href="#rejection">People's Rejection</a></li>
    <li><a href="#support">Support from a Man</a></li>
    <li><a href="#martyr">Martyrdom and Paradise</a></li>
    <li><a href="#punish">Divine Punishment</a></li>
    <li><a href="#ref">References</a></li>
  </ul>
</div>

      <!--Story of Luqman content-->
      <div class="story1">

        <h4 id="intro">Introduction to Dwellers of The Town</h4><br>
        <p>وَٱضْرِبْ لَهُم مَّثَلًا أَصْحَـٰبَ ٱلْقَرْيَةِ إِذْ جَآءَهَا ٱلْمُرْسَلُونَ ١٣ إِذْ أَرْسَلْنَآ إِلَيْهِمُ ٱثْنَيْنِ فَكَذَّبُوهُمَا فَعَزَّزْنَا بِثَالِثٍۢ فَقَالُوٓا۟ إِنَّآ إِلَيْكُم مُّرْسَلُونَ ١٤ قَالُوا۟ مَآ أَنتُمْ إِلَّا بَشَرٌۭ مِّثْلُنَا وَمَآ أَنزَلَ ٱلرَّحْمَـٰنُ مِن شَىْءٍ إِنْ أَنتُمْ إِلَّا تَكْذِبُونَ ١٥ قَالُوا۟ رَبُّنَا يَعْلَمُ إِنَّآ إِلَيْكُمْ لَمُرْسَلُونَ ١٦ وَمَا عَلَيْنَآ إِلَّا ٱلْبَلَـٰغُ ٱلْمُبِينُ ١٧ قَالُوٓا۟ إِنَّا تَطَيَّرْنَا بِكُمْ ۖ لَئِن لَّمْ تَنتَهُوا۟ لَنَرْجُمَنَّكُمْ وَلَيَمَسَّنَّكُم مِّنَّا عَذَابٌ أَلِيمٌۭ ١٨ قَالُوا۟ طَـٰٓئِرُكُم مَّعَكُمْ ۚ أَئِن ذُكِّرْتُم ۚ بَلْ أَنتُمْ قَوْمٌۭ مُّسْرِفُونَ ١٩ وَجَآءَ مِنْ أَقْصَا ٱلْمَدِينَةِ رَجُلٌۭ يَسْعَىٰ قَالَ يَـٰقَوْمِ ٱتَّبِعُوا۟ ٱلْمُرْسَلِينَ ٢٠ ٱتَّبِعُوا۟ مَن لَّا يَسْـَٔلُكُمْ أَجْرًۭا وَهُم مُّهْتَدُونَ ٢١ وَمَا لِىَ لَآ أَعْبُدُ ٱلَّذِى فَطَرَنِى وَإِلَيْهِ تُرْجَعُونَ ٢٢ ءَأَتَّخِذُ مِن دُونِهِۦٓ ءَالِهَةً إِن يُرِدْنِ ٱلرَّحْمَـٰنُ بِضُرٍّۢ لَّا تُغْنِ عَنِّى شَفَـٰعَتُهُمْ شَيْـًۭٔا وَلَا يُنقِذُونِ ٢٣ إِنِّىٓ إِذًۭا لَّفِى ضَلَـٰلٍۢ مُّبِينٍ ٢٤ إِنِّىٓ ءَامَنتُ بِرَبِّكُمْ فَٱسْمَعُونِ ٢٥ قِيلَ ٱدْخُلِ ٱلْجَنَّةَ ۖ قَالَ يَـٰلَيْتَ قَوْمِى يَعْلَمُونَ ٢٦ بِمَا غَفَرَ لِى رَبِّى وَجَعَلَنِى مِنَ ٱلْمُكْرَمِينَ ٢٧ ۞ وَمَآ أَنزَلْنَا عَلَىٰ قَوْمِهِۦ مِنۢ بَعْدِهِۦ مِن جُندٍۢ مِّنَ ٱلسَّمَآءِ وَمَا كُنَّا مُنزِلِينَ ٢٨ إِن كَانَتْ إِلَّا صَيْحَةًۭ وَٰحِدَةًۭ فَإِذَا هُمْ خَـٰمِدُونَ ٢٩</p> 
        <br>
        <p>Allah the Almighty says: {And put forward to them a similitude: the (story of the) dwellers of the town, when there came Messengers to them. When We sent to them two Messengers, they belied them both; so We reinforced them with a third, and they said: "Verily we have been sent to you as Messengers." They (people of the town) said: "You are only human beings like ourselves and the Most Gracious (Allah) has revealed nothing. You are only telling lies." The Messengers said: "Our Lord knows that we have been sent as Messengers to you." And our duty is only to convey plainly (the Message)." They (people) said: "For us, we see an evil omen from you: if you cease not, we will surely stone you, and a painful torment will touch you from us."They (Messengers) said: "Your evil omens be with you! (Do you call it "evil omen") because you are admonished? Nay, but you are a people Musrifun (transgressing all bounds by committing all kinds of great sins, and by disobeying Allah). And there came a man running from the farthest part of the town. He said: "O my people! Obey the Messengers. " “Obey those who ask no wages of you (for themselves), and who are rightly guided. "And why should I not worship Him (Allah Alone) Who has created me and to Whom you shall be returned." "Shall I take besides Him alihah (gods)? If the Most Gracious (Allah) intends me any harm, their intercession will be of no use for me whatsoever, nor can they save me?" "Then verily, I should be in plain error." “Verily! I have believed in your Lord, so listen to me!" It was said (to him when the disbelievers killed him): "Enter Paradise." He said: "Would that my people knew. "That my Lord (Allah) has forgiven me, and made me of the honored ones!" And We sent not against his people after him a host from the heaven, nor was it needful for Us to send (such a thing). It was but one Saihah (shout) and lo! They (all) were still (silent, dead, destroyed)}. (Ya-Sin, 13-29)</p>
        <br>
        <hr class="line">
        <br>
        <h4 id="messengers">Messengers Sent</h4>
        <br>
        <p>Abdullah Ibn 'Abbas, Ka'b Al-Ahbar and Wahb Ibn Munabih and many others narrated a story of a town called Antioch (Antakiyah), governed by the king Antikhis Ibn Antikhis. This king used to observe idol worship. Allah Almighty sent him three Messengers whom he severely belied. The Messengers were: Sadiq, Masduq and Shalom</p>
        <br>
        <p>It is evidently apparent that they were Messengers sent by Allah the Almighty. Qatadah claimed them to be messengers sent by Jesus Christ. The same view was held by Ibn Jarir after Wahb after Ibn Sulaiman after Shu' aib Al- Jiba'i who added that: those messengers were called: Shimon, Jonah and Paul and the town was called Antioch. This view is groundless because the people of Antioch when received three of the disciples of Jesus Christ (Peace be upon him) -were the first to believe in him at that very time. Thereupon, Antioch was one of the first four towns in which there first existed Christian Patriarchs. These four towns were Antioch, Jerusalem, Alexandria and Rome. However, the people of these towns were not destroyed, whereas the people of the aforementioned town in the Qur'anic verses were totally annihilated, following the killing of their companion whom Allah sent to admonish them. Allah the Almighty says: {It was but one Saihah (shout) and lo! They (all) were still (silent, dead and destroyed)}. (Ya-Sin, 29) There is no contradiction between the two interpretations, if the case was that the three Messengers of Allah were sent to the earlier dwellers of Antioch and that they were belied, the matter which incurred complete destruction. Then, their land was re-inhabited and during the lifetime of Jesus (Peace be upon him) the new dwellers believed in his three messengers.</p>
        <br>
        <p>The claim that the story mentioned in the Glorious Qur'an is that of the messengers of Jesus (Peace be upon him) is very absurd and groundless. Obviously, the context shows that they, the Messengers were sent by Allah the Almighty.</p>
        <br>
        <hr class="line">
        <br>
        <h4 id="rejection">People's Rejection</h4>
        <br>
        <p>Allah the Almighty says: {And put forward to them a similitude} i.e. for your people 0 Muhammad (Peace be upon him). {The (story of the) dwellers of the town, when there came Messengers to them. When We sent to them two Messengers, they belied them both, so We reinforced them with a third} i.e. We supported them with a third Messenger, {and they said: Verily we have been sent to you as Messengers}. The people of the town said that the Messengers were only human beings and they set aside the idea that Allah Almighty might send human beings as His Messengers to mankind. The Messengers asserted that Allah knows that they have been sent to them and that if they lie to Him, He would certainly give them the severest of all punishment. They added: {our duty is only to convey plainly (the Message)} i.e. what they were sent with and that guidance and misleading are in the Hand of Allah the Almighty Alone. {They (people) said: For us, we see an evil omen from you} i.e. from what you have brought us. {If you cease not, we will surely stone you} with bad words and stones as well; {and a painful torment will touch you from us} i.e. they threatened them with afflicting humiliation (bad words) and killing (stoning to death). {They (Messengers) said: Your evil omens be with you!} i.e. they will badly affect you. {(Do you call it "evil omen ") because you are admonished?} i.e. because we reminded you with guidance and invited you to it you threatened us with killing and afflicting humiliation. {Nay, but you are a people Musrifun} i.e. you transgress all bounds by committing all kinds of sinful deeds, and by disobeying Allah.</p>
        <br>
        <hr class="line">
        <br>
        <h4 id="support">Support from a Man</h4>
        <br>
        <p>Allah the Almighty says: {And there came a man running from the farthest part of the town} to support the Messengers and to declare his faith in them. {He said: 0 my people! Obey the Messengers. Obey those who ask no wages of you (for themselves), and who are rightly guided} i.e. they invite you to the absolute truth without asking wages or reward for themselves of you. Then he invited them to worship Allah Alone, and not to worship other than Him that can do nothing in this present life or in the Hereafter. {Then verily, I should be in plain error} i.e. if I abandoned the worship of Allah and worshipped anything else besides Him.</p>
        <br>
        <p>Then, the believing man said to the three Messengers: {Verily! I have believed in your Lord, so listen to me!}, i.e. you should listen to my statement and bear witness to this before your Lord. Or, 0 my people! Listen to my declaration of faith of these Messengers. Thereupon, the people killed him either by stoning him to death, or biting, or making one sudden assault against him. Narrated Ibn Ishaq after some of his counterparts on the authority of `Abdullah Ibn Mas’ud that the people stepped over his body till they broke his neck.</p>
        <br>
        <hr class="line">
        <br>
        <h4 id="martyr">Martyrdom and Paradise</h4>
        <br>
        <p>Narrated Ath-Thawri after `Asim Al-Ahwal after Abu Majlaz his saying: The name of that believing man was Habib Ibn Murriy who was said to be a carpenter, or rope-maker, or shoe-maker. It is also said that he used to observe his religious rituals in an isolated cave. `Abdullah Ibn `Abbas (May Allah be pleased with him) said: He was Habib, the carpenter who was afflicted with leprosy. He was charitable, but killed at the end at the hands of his own people. Then, Allah the Almighty says: {Enter Paradise} i.e. when he was killed by his people, Allah Almighty admitted him into Paradise. When he saw of the pleasures and joys therein, he said: {Would that my people knew? That my Lord (Allah) has forgiven me, and made me of the honoured ones!}, i.e. to believe in what I have believed in and thus gain what I have just obtained. Ibn `Abbas (May Allah be pleased with him) said: He advised his people during his life saying: {O my people! Obey the Messengers}, and after his death {Would that my people knew? That my Lord (Allah) has forgiven me, and made me of the honoured ones!}. In addition, Qatadah said: The believer always gives counselling because of what he sees of the rewards granted by Allah {Would that my people knew? That my Lord (Allah) has forgiven me, and made me of the honoured ones!}, i.e. he wished that his people would know the honour Allah bestowed on him. Qatadah added: By Allah! Allah did not admonish or even blame those people after killing him (the believing man) {It was but one Saihah (shout) and lo! They (all) were still (silent, dead, destroyed)}. Allah the Almighty says: {And We sent not against his people after him a host from the heaven, nor was it needful for Us to send (such a thing)}, i.e. it was not needful for Allah the Almighty to send against them a host from the heaven to avenge the Messengers.</p>
        <br>
        <hr class="line">
        <br>
        <h4 id="punish">Divine Punishment</h4>
        <br>
        <p>Mujahid and Qatadah said: This means that Allah did not send them another Message. Ibn Jarir said: The first interpretation looks more proper because Allah the Almighty says after this: {nor was it needful for Us to send (such a thing)}, i.e. Allah was not in need to send such a thing to punish them when they belied His Messengers and killed His godly man, {It was but one Saihah (shout) and lo! They (all) were still (silent, dead, destroyed)}.</p>
        <br>
        <p>Interpreters said: Allah the Almighty sent Gabriel (Peace be upon him) who maintained a grasp on their town's gate and made a single shout {one Saihah (shout) and lo! They (all) were still (silent, dead, destroyed)}, i.e. they turned to be silent, motionless and dead.</p>
        <br>
        <p>Finally, all these indicate that the town mentioned in the Qur'anic verses was not Antioch because the people of Antioch believed in Allah and followed the messengers of Jesus (Peace be upon him). Moreover, Antioch was said to be the first town to declare faith in Jesus (Peace be upon him).</p>
        <br>
        <hr class="line">
        <br>
        <h4 id="ref">References:</h4>
          <p>Stories of The Quran, by Ibn Kathir</p>
      </div>
      <script>
        function toggleSidenav() {
          var sidenav = document.getElementById("sidenav");
          if (sidenav.style.display === "block") {
            sidenav.style.display = "none";
          } else {
            sidenav.style.display = "block";
          }
        }
        </script>
        <script>
          $(document).ready(function() {
            var initialTop = $('.sidenav').css('top'); // Store the initial top value
            $(window).scroll(function() {
              var scroll = $(window).scrollTop(); // Get current scroll position
              $('.sidenav').css('top', Math.max(0, parseInt(initialTop) - scroll)); // Adjust top based on scroll
            });
          });
          </script>
          
        <script>
          function on() {
            document.getElementById("overlay").style.display = "block";
          }
          
          function off() {
            document.getElementById("overlay").style.display = "none";
          }
          function toggleBookmark(element, slug) {
            // Check if user is authenticated
            const isAuthenticated = document.body.getAttribute('data-user-authenticated') === 'true';
        
            if (!isAuthenticated) {
                window.location.href = '/account/signin/'; // Redirect to sign-in page
                return;
            }
        
            // Proceed with bookmark toggle for authenticated users
            fetch(`/toggle_bookmark/${slug}/`, {
                method: 'POST',
                headers: {
                    'X-CSRFToken': getCookie('csrftoken'), // Function to get CSRF token
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ 'slug': slug })
            })
            .then(response => response.json())
            .then(data => {
                if (data.bookmarked) {
                    element.classList.remove('fa-regular');
                    element.classList.add('fa-solid');
                } else {
                    element.classList.remove('fa-solid');
                    element.classList.add('fa-regular');
                }
            })
            .catch(error => console.error('Error:', error));
        }
        
        // Function to get CSRF token from cookies
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        document.addEventListener("DOMContentLoaded", function() {
            // Assuming the user is authenticated; adjust as needed
            updateUserBookmarkIcons();
        });
        
        function updateUserBookmarkIcons() {
            fetch('/get_user_bookmarks/', { // Adjusted to the correct path
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                    // Include CSRF token if needed for GET requests or ensure your view is exempt
                },
            })
            .then(response => response.json())
            .then(data => {
                const bookmarkedSlugs = data.bookmarkedSlugs;
                bookmarkedSlugs.forEach(slug => {
                    const bookmarkIcon = document.querySelector(`i[data-slug="${slug}"]`);
                    if (bookmarkIcon) {
                        bookmarkIcon.classList.remove('fa-regular');
                        bookmarkIcon.classList.add('fa-solid');
                    }
                });
            })
            .catch(error => console.error('Error:', error));
        }
        </script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        {% endblock content %}